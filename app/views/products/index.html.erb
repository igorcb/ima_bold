<p id="notice"><%= notice %></p>

<h1>Listagem de Produtos</h1>

<%= link_to 'Remover todos selecionados', destroy_selected_products_path  %>
<%= link_to "Ativar todos selecionados", ativate_selected_products_path %>
<%= link_to "Desativar todos selecionados", deactivate_selected_products_path %>

<div>
	<%= label_tag :categoria, "Categoria:"  %>
  <%= select_tag "categoria", options_from_collection_for_select(Category.order('name'), "id", "name") , include_blank: true %>
</div>

<hr>

<%= link_to "Novo Produto", new_product_path %>

<%= form_tag destroy_selected_products_path, :method => "delete", :id => "form_id", :remote => true do %>
  
	<table >
		<thead>
			<th><%= check_box_tag('check', 'check', false, :onClick => "checkAll(this);") %>Todos</th>
			<th>Nome</th>
			<th>Ativo</th>
			<th>Categoria</th>
			<th colspan="3">Opções</th>
		</thead>
		<tbody>
      
      <% @products.each do |product|   %>
      <tr>
        <td><%= check_box_tag "products_id[]", product.id %></td> 
        <td><%= link_to "#{product.name}", product %></td>
        <td><%= product.ativo_inativo %></td>
        <td><%= product.category.name %></td>
        <td><%= link_to "Editar", edit_product_path(product) %></td>
        <td><%= link_to "Deletar", product, method: :delete, data: { confirm: 'Deseja remover o produto?' } %></td>
      </tr>
      <% end %>

		</tbody>
	</table>

<% end %>

<script type="text/javascript">

function checkAll(check_all){
  var inputs = check_all.form.getElementsByTagName("input");
  for (var i = 0; i < inputs.length; i++) {  
    if (inputs[i].type == "checkbox" && inputs[i].name != check_all.name) { 
      if(check_all.checked == true){
        inputs[i].checked = true ;
      }else{
        inputs[i].checked = false ;
      }
    }  
  }  
}

</script>
